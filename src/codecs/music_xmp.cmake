option(USE_XMP         "Build with XMP library" ON)
if(USE_XMP)
    if(USE_SYSTEM_AUDIO_LIBRARIES)
        find_path(LIBXMP_INCLUDE_DIR xmp.h xmp/xmp.h)
        find_library(LIBXMP_LIB NAMES xmp)
        if(LIBXMP_INCLUDE_DIR AND LIBXMP_LIB)
            set(FOUND_LIBXMP 1)
        endif()
        message("XMP: [${FOUND_LIBXMP}] ${LIBXMP_INCLUDE_DIR} ${LIBXMP_LIB}")
    else()
        set(FOUND_LIBXMP 1)
        if(WIN32)
            add_definitions(-DBUILDING_STATIC)
        endif()
        if(DOWNLOAD_AUDIO_CODECS_DEPENDENCY)
            set(LIBXMP_LIB xmp)
        else()
            find_library(LIBXMP_LIB NAMES xmp
                         HINTS "${AUDIO_CODECS_INSTALL_PATH}/lib")
        endif()
    endif()
    if(FOUND_LIBXMP)
        message("== using libXMP ==")
        add_definitions(-DMUSIC_MOD_XMP)
        if(AUDIO_CODECS_REPO_PATH)
            list(APPEND SDL_MIXER_INCLUDE_PATHS ${AUDIO_CODECS_PATH}/libxmp/include)
        endif()
        list(APPEND SDLMixerX_LINK_LIBS ${LIBXMP_LIB})
        list(APPEND SDLMixerX_SOURCES
            ${CMAKE_CURRENT_LIST_DIR}/music_xmp.c)
    endif()
endif()

